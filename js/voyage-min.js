var Voyage=Voyage||{};!function($,t){var e=!1,n;t.Init=function(){function e(){Modernizr.touch?$(".project-item-list").addClass("project-item-touch"):$(".project-item-list").addClass("project-item-over"),t.Menu.init(),t.Marquee.init(),t.Projects.init(),t.ProjectView.init(),t.Contact.init()}return{init:e}}(),t.Menu=function(){function n(){$(".mobile-menu a").click(o),$(".nav-bar a").click(i),$(".mobile-link").click(i),$(".logo").click(i),$(".mobile-link").click(r)}function i(){var n=$(this).attr("path");e?t.ProjectView.hideProject(n):$(window).scrollTo(n,250)}function o(){"none"==$(".mobile-container").css("display")?a():r()}function a(){TweenLite.to($(".header-bar"),.25,{top:180}),$("#header").height(250),$(".mobile-container").show(),$(".mobile-menu a div").hide(),$(".mobile-menu a").addClass("mobileclose"),TweenLite.to($(".mobile-container"),.25,{top:0})}function r(){TweenLite.to($(".header-bar"),.25,{top:0}),$(".mobile-menu a div").show(),$(".mobile-menu a").removeClass("mobileclose"),TweenLite.to($(".mobile-container"),.25,{top:-180,onComplete:function(){$(".mobile-container").hide(),$("#header").height(70)}})}return{init:n}}(),t.Projects=function(){function t(){e(),n(),l=new TimelineLite}function e(){u=["artdirection","development","design","web","tablet","mobile","flash","game","social","banners"],r=$(".work-filter-types a"),r.click(i),d=[],r.each(function(t){$(this).attr("type",u[t]),d.push({t:$(this),n:0})})}function n(){c=$(".project-item-list"),c.each(function(t){var e=$(this);e.attr("num",t);for(var t=0;t<u.length;t++)"true"==e.attr(u[t])&&d[t].n++}),$(".project-item-over").hover(function(){TweenLite.to($(this),.2,{height:"450px","margin-top":"-50px"})},function(){TweenLite.to($(this),.2,{height:"350px","margin-top":"0px"})}),r.each(function(t){0==d[t].n&&d[t].t.hide()})}function i(){if(s=$(this),s.hasClass("selected")){s.removeClass("selected"),l.pause(),l=new TimelineLite;for(var t=c.length-1;t>=0;t--)"block"==c.eq(t).css("display")&&l.add(TweenLite.to(c.eq(t),f,{height:"0px",ease:Quad.easeOut,onComplete:function(){this.target.hide()}}));l.call(a)}else{r.removeClass("selected"),s.addClass("selected"),l.pause(),l=new TimelineLite;for(var t=c.length-1;t>=0;t--)"block"==c.eq(t).css("display")&&l.add(TweenLite.to(c.eq(t),f,{height:"0px",ease:Quad.easeOut,onComplete:function(){this.target.hide()}}));l.call(o)}}function o(){for(var t=0;t<c.length;t++)"true"==$(c[t]).attr(s.attr("type"))&&(c.eq(t).css("height","0px").show(),l.add(TweenLite.to(c.eq(t),f,{height:"350px",ease:Quad.easeOut,onComplete:function(){this.target.css("height","")}})))}function a(){for(var t=0;t<c.length;t++)c.eq(t).css("height","0px").show(),l.add(TweenLite.to(c.eq(t),f,{height:"350px",ease:Quad.easeOut}))}var r,c,s,l,u,d,f=.2;return{init:t}}(),t.ProjectView=function(){function n(){$(".project-view").hide(),$(".view-project-btn").click(o),i()}function i(){$(".close-project-btn").click(function(){a("#work")}),$(".projview-next .view-project-btn").click(l)}function o(){e=!0,t.Marquee.stop(),r($(this),$(".project-view")),$(window).scrollTo(0,300,function(){TweenMax.to($(".container"),.3,{scaleX:.7,scaleY:.7,opacity:0,transformOrigin:"center top",delay:.1,onComplete:function(){$(".container").hide(),$(".project-view").css("top","100%").show(),TweenMax.to($(".project-view"),.3,{top:"0%",onComplete:function(){i()}})}})})}function a(n){d=n,$(window).scrollTo(0,300,function(){TweenMax.to($(".project-view"),.3,{top:"100%",delay:.1,onComplete:function(){$(".project-view").hide(),$(".container").show(),TweenMax.to($(".container"),.3,{scaleX:1,scaleY:1,opacity:1,transformOrigin:"center top",onComplete:function(){e=!1,$(".container").attr("style",""),t.Marquee.start(),setTimeout(u,250)}})}})})}function r(t,e){var n=$("#"+t.attr("t"));n.attr("viewed","true"),e.find(".project-marquee").css("background-image",n.find(".project-item-list").css("background-image")),e.find(".projview-copy").html(n.find(".project-content").html()),e.find(".projview-ta").css("background-image",n.find(".project-ta").css("background-image")),e.find(".projview-title").text(n.find(".project-title").text()),e.find(".pj-left p").html(n.find(".project-features").html()),"true"!=n.find(".project-item-list").attr("mobile")?e.find(".notmobile").addClass("shownotmobile"):e.find(".notmobile").removeClass("shownotmobile"),"true"!=n.find(".project-item-list").attr("tablet")?e.find(".nottablet").addClass("shownottablet"):e.find(".nottablet").removeClass("shownottablet");var i=n.find(".project-link").text();""==i?$(".pj-right").hide():(e.find(".pj-right a").attr("href",i),$(".pj-right").show()),e.find(".paging-scroll").html(""),h=[],p=[],f=$(".project-item"),f.each(function(t){var e=$(this);"true"!=e.attr("viewed")?h.push(e):p.push(e)}),s(h),s(p);for(var o in h)c(h[o],e,t.attr("t"),"not");for(var o in p)c(p[o],e,t.attr("t"),"viewed")}function c(t,e,n,i){var o='<div class="projview-next" href="javascript:void(0);">';o+='<div class="projbtn-copy">',o+='<div class="projbtn-ta"></div>',o+='<div class="projbtn-title"></div>',o+='<a href="javascript:void(0);" class="view-project-btn" t="">',o+="VIEW PROJECT",o+='<span class="view-project-over">VIEW PROJECT</span>',o+="</a>",o+="</div>",o+="</div>";var a=$("#"+t.attr("id"));if(console.log(t.attr("id"),i,a.find(".project-title").text()),t.attr("id")!=n){var r=$(o).appendTo(e.find(".paging-scroll"));r.css("background-image",a.find(".project-item-list").css("background-image")),r.find(".projbtn-ta").css("background-image",a.find(".project-ta").css("background-image")),r.find(".projbtn-title").text(a.find(".project-title").text()),r.find(".view-project-btn").attr("t",t.attr("id"))}}function s(t){var e=[];for(var n in t)e[n]={o:t[n],i:1e4*Math.random()};e.sort(function(t,e){return t.i-e.i});for(var n in e)t[n]=e[n].o}function l(){var t=$(this),e=$(".project-view"),n=e.clone();n.insertAfter($("#header")),r(t,n),n.css("left","100%"),$(window).scrollTo(0,300,function(){TweenMax.to(e,.3,{scaleX:.7,scaleY:.7,opacity:0,transformOrigin:"left 15%",delay:.1,onComplete:function(){e.remove(),TweenMax.to(n,.3,{left:"0%",onComplete:function(){i()}})}})})}function u(){$(window).scrollTo(d,300)}var d,f,h=[],p=[],m=[];return{init:n,hideProject:a}}(),t.Contact=function(){function t(){$(".contact-submit").click(n),e($(".contact-p div")),e($(".contact-e a"))}function e(t){var e=t.text();e=e.split("/").join(""),t.text(e),e=t.attr("href"),void 0!=e&&(e=e.split("/").join(""),t.attr("href",e))}function n(){if(i()){$(".contact-wrapper").hide();var t="name="+o+"&email="+a+"&message="+r;$.ajax({type:"POST",url:"http://voyagecreative.com/wp-content/themes/voyage/data/mail.php",data:t,success:function(t){$(".send-success").fadeIn("fast")}})}}function i(){if(o=document.forms.contactform.contactname.value,a=document.forms.contactform.contactemail.value,r=document.forms.contactform.contactmessage.value,o.length<1)return $(".errormessage").text("* Please enter a valid name").show(),!1;var t=a.indexOf("@"),e=a.lastIndexOf(".");return 1>t||t+2>e||e+2>=a.length?($(".errormessage").text("* Please enter a valid email address").show(),!1):r.length<1?($(".errormessage").text("* Please enter a valid message").show(),!1):($(".errormessage").hide(),!0)}var o,a,r;return{init:t}}(),t.Marquee=function(){function t(){current=0,d=$(".voyage-headline"),f=$(".voyage-type"),h=$(".voyage-voyage"),p=$(".voyage-copy"),m=$(".marquee-item"),v=$("#marquee .view-project-btn"),e(),m.length>1&&i()}function e(){p.text(m.eq(current).attr("copy")),f.html(m.eq(current).attr("title").toUpperCase()+"&nbsp;"),v.attr("t",m.eq(current).attr("t"))}function n(){m.length>1&&i()}function i(){w=setTimeout(function(){a()},s)}function o(){clearTimeout(w)}function a(){.64*$(window).width()<f.width()+h.width()?f.fadeOut(l,function(){p.slideUp("fast",function(){m.eq(current).fadeOut("fast",function(){r()})})}):f.animate({width:"0px"},l,function(){f.height(0),p.slideUp("fast",function(){m.eq(current).fadeOut("fast",function(){r()})})})}function r(){current++,current==m.length&&(current=0),p.text(m.eq(current).attr("copy")),f.html(m.eq(current).attr("title").toUpperCase()+"&nbsp;"),v.attr("t",m.eq(current).attr("t")),f.css({height:"auto",width:"auto"}),.64*$(window).width()<f.width()+h.width()?m.eq(current).fadeIn("fast",function(){p.slideDown("fast",function(){f.css({height:"auto",width:"auto"}),f.fadeIn("fast",function(){i()})})}):(f.css({width:"0px"}),m.eq(current).fadeIn("fast",function(){p.slideDown("fast",function(){f.show(),f.css({height:"auto",width:"auto"});var t=f.width();f.css({width:"0px"}),f.animate({width:t+"px"},l,function(){f.css({width:"auto"}),i()})})}))}function c(){mobile?$(window).width()>960&&(mobile=!1):$(window).width()<960&&(mobile=!0,clearTimeout(w),f.text())}var s=7e3,l=500,u=14,d,f,h,p,m,w,v;return current=0,mobile=!1,{init:t,start:n,stop:o}}(),$(document).ready(function(){t.Init.init()})}(jQuery,Voyage);